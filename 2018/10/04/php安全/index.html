<!DOCTYPE html>
<html>
    <!-- title -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" >
    <meta name="author" content="threst">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="threst">
    <meta name="keywords" content="Hexo | threst">
    <meta name="description" content="">
    <meta name="Cache-Control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>php安全 · threst&#39;s Blog</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s 1;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href= /css/style.css?v=20180501 as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="stylesheet" href= /css/mobile.css?v=20180501 media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
        
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href= "/" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script" />    
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script" />
    <link rel="preload" href="/scripts/main.js" as="script" />
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >threst&#39;s Blog</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">php安全</a>
            </div>
    </div>
    
    <a class="home-link" href=/>threst's Blog</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style=








height:50vh;

>
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/2.png)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            php安全
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <!-- 文章页标签  -->
            
                <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "php">php</a>
    
</div>
            
            <div class="post-intro-meta">
                <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                <span class="post-intro-time">2018/10/04</span>
                
                <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                    <span class="iconfont-archer">&#xe602;</span>
                    <span id="busuanzi_value_page_pv"></span>
                </span>
                
                <span class="shareWrapper">
                    <span class="iconfont-archer shareIcon">&#xe71d;</span>
                    <span class="shareText">Share</span>
                    <ul class="shareList">
                        <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                            <div class="share-qrcode"></div>
                        </li>
                        <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                        <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                        <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                        <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                    </ul>
                </span>
            </div>
        
    </div>
</div>
        <script>
  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }
  
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntroTags = document.getElementsByClassName('post-intro-tags')[0],
        postIntroMeat = document.getElementsByClassName('post-intro-meta')[0];
      if (postIntroTags) {
        postIntroTags.classList.add('post-fade-in');
      }
      if (postIntroMeat) {
        postIntroMeat.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <h1 id="0x01-PHP敏感配置项"><a href="#0x01-PHP敏感配置项" class="headerlink" title="0x01 PHP敏感配置项"></a>0x01 PHP敏感配置项</h1><h2 id="register-globals-php版本小于5-4时存在"><a href="#register-globals-php版本小于5-4时存在" class="headerlink" title="register_globals(php版本小于5.4时存在)"></a>register_globals(php版本小于5.4时存在)</h2><p>当该配置项为ON时，会把用户通过GET、POST提交的参数自动注册成全局变量。当代码中存在有未初始化的变量时，可能会导致变量覆盖的问题；</p>
<p>(PS:其中参数覆盖的顺序受到配置文件中variables_order的参数影响，默认是EGPCS。按顺序，右边的参数来源会覆盖左边的的参数来源)</p>
<h2 id="allow-url-include-php版本大于5-2默认为off"><a href="#allow-url-include-php版本大于5-2默认为off" class="headerlink" title="allow_url_include(php版本大于5.2默认为off)"></a>allow_url_include(php版本大于5.2默认为off)</h2><p>当该配置项为ON时，可以通过include、require等函数进行远程文件包含</p>
<p>其中有个类似的配置项是allow_url_fopen，这个参数配置为on的时候可以函数中例如file_get_contents中打开url。</p>
<p>当两个配置项都为ON的时候，可以直接使用url进行远程包含，当include为ON，fopen为OFF时，只能通过php伪协议进行包含</p>
<h2 id="magic-quato-gpc（php版本小于5-4存在）"><a href="#magic-quato-gpc（php版本小于5-4存在）" class="headerlink" title="magic_quato_gpc（php版本小于5.4存在）"></a>magic_quato_gpc（php版本小于5.4存在）</h2><p>此配置项为ON的时候会对GET、POST、COOKIE变量中的单引号(‘)、双引号(“)、反斜杠（）、空字符(NULL)前添加反斜杠进行转义，注意：这个配置并不会对SERVER变量里的特殊字符进行转义，因此可能会导致referer、client-ip存在注入等漏洞</p>
<h2 id="magic-quato-runtime（php版本小于5-4存在）"><a href="#magic-quato-runtime（php版本小于5-4存在）" class="headerlink" title="magic_quato_runtime（php版本小于5.4存在）"></a>magic_quato_runtime（php版本小于5.4存在）</h2><p>这个配置和magic_quato_gpc的区别就在于runtime是对从数据库或者文件中取出的数据进行转义，因此只对例如file()、fgets()、fread（）、mysql_fetch_array（）等很多对数据库查询和文件读取的函数产生影响</p>
<h2 id="magic-quato-sybase（php版本小于5-4存在）"><a href="#magic-quato-sybase（php版本小于5-4存在）" class="headerlink" title="magic_quato_sybase（php版本小于5.4存在）"></a>magic_quato_sybase（php版本小于5.4存在）</h2><p>这个配置和magic_quato_gpc 的区别在于，sybase只会转义空字符，把单引号转为双引号，并且这个配置如果为ON会覆盖gpc的配置</p>
<h2 id="open-basedir"><a href="#open-basedir" class="headerlink" title="open_basedir"></a>open_basedir</h2><p>这个配置用来设置限定php程序只能访问哪些目录。在windows下，多个目录用分号（;）分割，linux下用冒号(:)进行分割。注意的是配置的目录需要用斜杠（/）进行封尾，否则就变成了前缀匹配。例如，配置/var/test，那么/var/test和/var/test123都是可以进行访问的，如果指定一个确定的目录就要写成/var/test/</p>
<h1 id="0x02-PHP常见敏感函数"><a href="#0x02-PHP常见敏感函数" class="headerlink" title="0x02 PHP常见敏感函数"></a>0x02 PHP常见敏感函数</h1><pre><code>注入: select from,mysql_connect,mysql_query,mysql_fetch_*,update,insert,delete
宽字节注入: set names gbk、character_set_client=gbk mysql_set_charset(&apos;gbk&apos;),iconv
二次编码注入: urldecode,rawurldecode
文件包含 : include,include_once 、require、require_once
文件上传 : move_upload_file
任意文件删除 : unlink、session_destory
代码注入 : eval assert,preg_replace(/e),call_user_func,call_user_func_array,array_map等
命令执行: system、exec、shell_exec、passthru 、pctnl_exec、popen、proc_exec、
变量覆盖: extract、parse_str、$$
反序列化: unserialize
随机数: rand、mt_rand
</code></pre><h1 id="0x03-常见漏洞解析"><a href="#0x03-常见漏洞解析" class="headerlink" title="0x03 常见漏洞解析"></a>0x03 常见漏洞解析</h1><h2 id="各种问题可以导致系统重装"><a href="#各种问题可以导致系统重装" class="headerlink" title="各种问题可以导致系统重装"></a>各种问题可以导致系统重装</h2><p>一般程序都是通过判断install文件下有没有安装过程中生成的以lock为后缀的文件或者config配置文件来判断有没有安装。</p>
<h3 id="1-未对系统是否已经安装进行判断"><a href="#1-未对系统是否已经安装进行判断" class="headerlink" title="1.未对系统是否已经安装进行判断"></a>1.未对系统是否已经安装进行判断</h3><p>例如PHPSHE B2C商城1.6（wooyun 2014-062047）<br>可以看到代码未对是否安装进行任何判断，直接进入安装流程</p>
<h3 id="2-变量覆盖绕过"><a href="#2-变量覆盖绕过" class="headerlink" title="2.变量覆盖绕过"></a>2.变量覆盖绕过</h3><p>例如frcms (wooyun 2014-073244)<br>其中主要的漏洞代码是</p>
<pre><code>foreach(Array(&apos;_GET&apos;,&apos;_POST&apos;,&apos;_COOKIE&apos;) as $_request){
    foreach($$_request as $_k =&gt; $_v) ${$_k} = _runmagicquotes($_v);
}
</code></pre><p>他会把你从GET、POST、COOKIE中的变量注册为全局变量，因此我们直接通过GET参数提交$insLockfile变量即可绕过</p>
<h3 id="3-判断已安装后未exit-退出程序"><a href="#3-判断已安装后未exit-退出程序" class="headerlink" title="3.判断已安装后未exit()退出程序"></a>3.判断已安装后未exit()退出程序</h3><p>例如startbbs （wooyun-2013-045143）</p>
<pre><code>class Install extends Install_Controller
{
function __construct ()
{
    parent::__construct();
    $this-&gt;load-&gt;library(&apos;myclass&apos;);
    $file=FCPATH.&apos;install.lock&apos;;
    if (file_exists($file)){
        $this-&gt;myclass-&gt;notice(&apos;alert(&quot;系统已安装过&quot;);window.location.href=&quot;&apos;.site_url().&apos;&quot;;&apos;);
    }
}
</code></pre><p>可以看到其中判断install.lock文件存在后直接使用js代码将用户进行重定向，但是并没有die程序，直接从前端删除返回的js代码即可重装</p>
<h3 id="4-还可以借助任意文件删除的漏洞来删除lock文件，然后进行重装（PS-这个就留在任意文件删除再分析）"><a href="#4-还可以借助任意文件删除的漏洞来删除lock文件，然后进行重装（PS-这个就留在任意文件删除再分析）" class="headerlink" title="4.还可以借助任意文件删除的漏洞来删除lock文件，然后进行重装（PS:这个就留在任意文件删除再分析）"></a>4.还可以借助任意文件删除的漏洞来删除lock文件，然后进行重装（PS:这个就留在任意文件删除再分析）</h3><p>例如: 用thinkphp 改造的hdcms （wooyun-2015-092061）<br>我们先跟着框架走一遍，首先查看入口文件index.php</p>
<p>首先定义了一些基本的框架目录，然后就直接开始引入框架文件，我们进入框架初始化文件hdphp.php</p>
<p>前面还是检测一次是否成功初始化常量，然后检测是否进行过编译，否则就载入文件进行首次编译，然后进行boot的run方法，查看该方法内容。</p>
<p>前面依然是定义了各种常量，我们可以直接跳过，来到最后的应用初始化，查看该方法</p>
<p>可以看到module_path常量是通过将get形式提交的var_group参数进行拼接的，然后又将module_path拼接入module_config_path，最后使用require进行了文件包含。（PS:因为这里后面制定了config.php，所以需要用到%00进行截断）</p>
<p>但是我们分析到目前为止只能说是疑似存在文件包含漏洞，我们还要看GET参数接收时有没有进行过滤，于是我们进入之前的解析路由方法route::parseurl()，代码较长我就不贴图了，里面就是将url中的参数进行截取解析，没有进行任何的过滤和检测，因此可以确定此处存在文件包含漏洞。因此我们接下来需要确定输入点，可以发现变量是通过thinkphp中获取参数的C方法进行获取的，而C方法获取的变量在config.php中，于是我们查看文件中可以看到var_group对应的变量是g</p>
<p>因此我们可以先上传一个文件然后index.php?g=../test.php%00</p>
<p>之前的文件包含漏洞我们是通过index.php这个入口文件一步步搞懂cms框架然后进行审计。除了这种方法，我们还可以直接定位数据库查询语句或者功能附近，看看传入的数据有没有被进行清洗。</p>
<p>注入漏洞这里我们就用两个有意思的骚操作来分析一下</p>
<h4 id="1-Ecshop-支付宝插件全局转义绕过导致sql注入"><a href="#1-Ecshop-支付宝插件全局转义绕过导致sql注入" class="headerlink" title="1.Ecshop 支付宝插件全局转义绕过导致sql注入"></a>1.Ecshop 支付宝插件全局转义绕过导致sql注入</h4><p>其实在ECshop中的init.php中对用户输入的参数进行了全局转义</p>
<p>但是我们来到来到案发现场看看，巧妙的运用str_replace的替换功能来帮助单引号进行逃逸</p>
<p>其中的核心漏洞代码是$order_sn = str_replace($_GET[‘subject’], ‘’, $_GET[‘out_trade_no’]);其中代码对用户提交的out_trade_no参数中将subject替换为空，然后送入check_money函数中的sql查询语句.<br>这个漏洞的关键在于str_replace函数中的替换内容和源字符串都是可控的。<br>理解这个漏洞之前我们再来回顾一下php中addslashes中的转义处理机制[--&gt;\,”–&gt;\”,”–&gt;\”,null–&gt;\0]<br>于是我们可以提交out_trade_no参数为%00’后面再跟上我们的payload，提交的subject参数为0，我们来看一下数据转换过程.<br>out_trade_no=%00’ ————&gt;经过全局gpc转义————&gt; out_trade_no=\0\’————&gt;送入str_replace函数处理，将0替换————&gt;out_trade_no=\‘ 也就是等于了’，最终也就成功在sql语句中引入了一个单引号，从而可以进行注入</p>
<h4 id="2-格式化字符串导致的单引号逃逸"><a href="#2-格式化字符串导致的单引号逃逸" class="headerlink" title="2.格式化字符串导致的单引号逃逸"></a>2.格式化字符串导致的单引号逃逸</h4><p>再来分析一下前段时间出来的wordpress格式化字符导致的注入</p>
<p>具体的代码分析在这就不贴图了，我们直接来分析一下格式化字符串漏洞的核心原理，其中一个关键点就是sprintf的padding特性</p>
<p>printf（）和sprintf（）函数中可以通过使用%接一个字符来进行padding功能</p>
<p>例如%10s 字符串会默认在左侧填充空格至长度为10，还可以 %010s 会使用字符0进行填充，但是如果我们想要使用别的字符进行填充，需要使用 ‘ 单引号进行标识，例如 %’#10s 这个就是使用#进行填充（百分号不仅会吃掉’单引号，还会吃掉 斜杠）</p>
<p>同时sprintf（）可以使用指定参数位置的写法</p>
<p>%后面的数字代表第几个参数，$后代表格式化类型</p>
<p>于是当我们输入的特殊字符被放到引号中进行转义时，但是又使用了sprintf函数进行拼接时,例如%1$’%s’ 中的 ‘%被当成使用%进行padding，导致后一个’逃逸了</p>
<p>还有一种情况就是’被转义成了’,例如输入%’ and 1=1#进入，存在SQL过滤，’被转成了\’<br>于是sql语句变成了select * from user where username = ‘%\’ and 1=1#’;<br>如果这个语句被使用sprintf函数进行了拼接，%后的被吃掉了，导致了’逃逸</p>
<pre><code>&lt;?php
$sql = &quot;select * from user where username = &apos;%\&apos; and 1=1#&apos;;&quot;;
$args = &quot;admin&quot;;
echo sprintf( $sql, $args ) ;
//result: select * from user where username = &apos;&apos; and 1=1#&apos;
?&gt;
</code></pre><p>不过这样容易遇到 PHP Warning: sprintf(): Too few arguments的报错<br>这个时候我们可以使用%1$来吃掉转移添加的\</p>
<pre><code>&lt;?php
$sql = &quot;select * from user where username = &apos;%1$\&apos; and 1=1#&apos; and password=&apos;%s&apos;;&quot;;
$args = &quot;admin&quot;;
echo sprintf( $sql, $args) ;
//result: select * from user where username = &apos;&apos; and 1=1#&apos; and password=&apos;admin&apos;;
?&gt;
</code></pre><h1 id="0x03-php安全"><a href="#0x03-php安全" class="headerlink" title="0x03 php安全"></a>0x03 php安全</h1><h2 id="strcmp-弱类型比较特性"><a href="#strcmp-弱类型比较特性" class="headerlink" title="strcmp 弱类型比较特性"></a>strcmp 弱类型比较特性</h2><p>strcmp是C与PHP中常用的一个函数，用来比较两个字符串是否相等。如果二者相等，则返回数字0，否则返回其他数字。 strcmp函数当我们传入一个数组和一个字符串时，将会触发一个警告，函数返回FALSE。由于PHP弱类型的特性，FASLE == 0，会让系统误认为返回的值是0，最后绕过strcmp函数的判断。</p>
<h2 id="Linux-PHP-写入与删除文件差异特性"><a href="#Linux-PHP-写入与删除文件差异特性" class="headerlink" title="Linux PHP 写入与删除文件差异特性"></a>Linux PHP 写入与删除文件差异特性</h2><p>有时候目标网站存在任意文件上传漏洞，但操作执行完成后即刻删除，导致我们的webshell无法保留在服务器上。这种情况多存在于一些有缓存文件、临时文件的逻辑中，在实战里经常遇到。 Linux下，php的文件写入与移动删除等操作中，由于对于路径的处理存在差异，在有上述情况存在时，我们可以通过传入文件名为shell.php/.的文件，绕过删除函数。</p>
<h2 id="preg-replace-利用-0-截断执行代码"><a href="#preg-replace-利用-0-截断执行代码" class="headerlink" title="preg_replace 利用 \0 截断执行代码"></a>preg_replace 利用 \0 截断执行代码</h2><p>有些情况下，我们可控preg_replace的第一个参数（正则表达式）中的部分内容。 在PHP5.4.7以前，preg_replace的第一个参数可以利用\0进行截断，并将正则模式修改为e。众所周知，e模式的正则支持执行代码，此时将可构造一个任意代码执行漏洞。</p>
<h2 id="利用php-filter流绕过死亡exit"><a href="#利用php-filter流绕过死亡exit" class="headerlink" title="利用php filter流绕过死亡exit"></a>利用php filter流绕过死亡exit</h2><p>很多开发者在写入缓存、日志、配置文件的时候，通过在文件开头增加&lt;?php exit; ?&gt;。此时，即使用户控制文件内容，也无法执行。 我们可以利用PHP的filter流，通过php://filter/write=string.strip_tags|convert.base64-decode/resource=config.php来写入文件。 此时，PHP会先用strip_tags去除死亡exit，再将webshell用base64-decode还原，最终写入的文件中不再有死亡exit。</p>
<h2 id="filter-var-FILTER-VALIDATE-EMAIL-绕过"><a href="#filter-var-FILTER-VALIDATE-EMAIL-绕过" class="headerlink" title="filter_var FILTER_VALIDATE_EMAIL 绕过"></a>filter_var FILTER_VALIDATE_EMAIL 绕过</h2><p>filter_var是一组PHP中过滤、检测用户输入的方法，其中开发者通常利用filter_var($email, FILTER_VALIDATE_EMAIL)来过滤用户输入的邮箱。 RFC 3696规定邮箱local part部分可以用双引号包裹，双引号内即可填入任意字符。 我们可以利用RFC 3696，传入”aaa’aaa”@example.com，即可保留单引号，并通过filter_var的检测，最终触发SQL注入漏洞。</p>
<h2 id="控制Nginx虚拟主机的Host"><a href="#控制Nginx虚拟主机的Host" class="headerlink" title="控制Nginx虚拟主机的Host"></a>控制Nginx虚拟主机的Host</h2><p>在同一服务器上运行多个网站，Nginx会根据HTTP数据包中的Host头来区分用户访问的是哪个网站。我们如果修改Host头的值，将不能进入指定的网站。 此时，我们可以借助Nginx特性，用如下两个方法在$_SERVER[‘HTTP_HOST’]中注入恶意代码： 1. 在存在两个Host头时，Nginx取到的是第1个，PHP中取到的是第2个。我们将恶意代码放在第2个位置，将可控制$_SERVER[‘HTTP_HOST’] 2. Nginx在处理Host时，会将Host用冒号分割成hostname和port，port部分被丢弃。所以，将恶意代码放在port位置，即可部分控制$_SERVER[‘HTTP_HOST’]</p>
<h2 id="利用GBK编码吃反引号"><a href="#利用GBK编码吃反引号" class="headerlink" title="利用GBK编码吃反引号"></a>利用GBK编码吃反引号</h2><p>在开启GPC或模拟全局GPC的CMS中，我们传入的单引号（’）和转义符（\）等将被用一个转义符（\）进行转义，导致我们无法闭合单引号进行注入。 在GBK编码的程序中，部分开发者会用iconv将字符串转换编码后存入数据库。在这种情况下，我们可以利用GBK编码中的0xE55C，转义正常的反斜线，绕过全局GPC进行注入。</p>
<h2 id="iconv-绕过上传白名单"><a href="#iconv-绕过上传白名单" class="headerlink" title="iconv()绕过上传白名单"></a>iconv()绕过上传白名单</h2><p>在上传文件的过程中，如果目标使用的字符编码和访客操作系统使用的字符编码不同，可能导致上传后的文件名出现乱码。所以，开发者在获取文件名后，通常调用iconv()对其进行编码转换。 如果转换编码的操作在验证文件名后缀操作之后，那么我们可以利用iconv()特性，截断文件名，进而去除白名单中的后缀，造成文件上传漏洞。</p>
<h2 id="PHP-mt-rand-随机数预测"><a href="#PHP-mt-rand-随机数预测" class="headerlink" title="PHP mt_rand() 随机数预测"></a>PHP mt_rand() 随机数预测</h2><p>mt_rand()生成随机数有如下特点： 1. PHP &gt; 4.2.0中，系统会自动设置随机数种子，相同种子生成的随机数相同 2. 同一进程中，如果多次调用mt_rand()函数，只会自动播种一次 所以，如果同一次我们生成了数个随机数，在知道其中一部分的情况下，即可反推随机数种子。 32位系统中，种子最大值为2^16-1，64位系统中，种子最大值为2^31-1。我们爆破到该种子，即可预测其他未知的随机数。<br><a href="https://mp.weixin.qq.com/s/3TgBKXHw3MC61qIYELanJg" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/3TgBKXHw3MC61qIYELanJg</a></p>
<h2 id="PHP5-rand-随机数预测"><a href="#PHP5-rand-随机数预测" class="headerlink" title="PHP5 rand() 随机数预测"></a>PHP5 rand() 随机数预测</h2><p>PHP5 rand()函数使用了glibc库中的rand()函数，glibc中维护了一个随机数链，其上下文中存在如下关系： state[i] = state[i-3] + state[i-31] return state[i] &gt;&gt; 1 进而导致PHP5中的rand()函数生成的随机数也存在上述关系。如果开发者使用rand()函数生成密钥、salt等安全相关元素，将导致被预测。</p>
<h2 id="利用json-encode吃转义符"><a href="#利用json-encode吃转义符" class="headerlink" title="利用json_encode吃转义符"></a>利用json_encode吃转义符</h2><p>在开启GPC或模拟全局GPC的CMS中，我们传入的单引号（’）和转义符（\）等将被用一个转义符（\）进行转义，导致我们无法闭合单引号进行注入。 部分开发者会将一些结构复杂内容（如数组）用json_encode编码成一个字符串后存入数据库，在这种情况下，我们可以绕过全局GPC进行注入</p>
<h2 id="file-put-contents写入文件绕过内容黑名单"><a href="#file-put-contents写入文件绕过内容黑名单" class="headerlink" title="file_put_contents写入文件绕过内容黑名单"></a>file_put_contents写入文件绕过内容黑名单</h2><p>在开发者使用file_put_contents写入文件的时候，有的情况下会用字符串匹配的方式拦截如“&lt;”、”&gt;”、”?”等字符，导致我们无法写入webshell。 file_put_contents函数第二个参数支持传入数组，用户传入的数组将被拼接成一个字符串写入文件。数组因为类型不同导致无法使用字符串匹配来检测，进而利用这种方式绕过了黑名单。</p>
<h2 id="PHP-MD5-比较的陷阱"><a href="#PHP-MD5-比较的陷阱" class="headerlink" title="PHP MD5 比较的陷阱"></a>PHP MD5 比较的陷阱</h2><p>PHP是一门弱类型语言，在使用“==”进行变量比较的时候，会先进行类型转换，再进行比较操作。即使比较的是两个字符串，如果二者满足“科学计数法”的表达方法，也会先转换成数字再进行比较。 比如： var_dump(“0e1234” == “0e5678”); 其返回结果是true。 在比较md5时，如果目标密码的md5值恰好是“0e”+数字，将可以出现密码绕过漏洞。</p>
<h2 id="PHP-5-6-11-数组比较Bug"><a href="#PHP-5-6-11-数组比较Bug" class="headerlink" title="PHP 5.6.11 数组比较Bug"></a>PHP 5.6.11 数组比较Bug</h2><p>PHP 5.6.11/5.5.27/5.4.44以前的版本中，存在一处数组比较的Bug（Bug #69892），我们可以通过 var_dump([0 =&gt; 0] === [0x100000000 =&gt; 0]); 来复现该特性。</p>
<h1 id="0x04-代码审计关注点）"><a href="#0x04-代码审计关注点）" class="headerlink" title="0x04 代码审计关注点）"></a>0x04 代码审计关注点）</h1><h2 id="file-put-contents、copy、file-get-contents等读取写入操作与unlink、file-exists等删除判断文件函数之间对于路径处理的差异导致的删除绕过"><a href="#file-put-contents、copy、file-get-contents等读取写入操作与unlink、file-exists等删除判断文件函数之间对于路径处理的差异导致的删除绕过" class="headerlink" title="file_put_contents、copy、file_get_contents等读取写入操作与unlink、file_exists等删除判断文件函数之间对于路径处理的差异导致的删除绕过"></a>file_put_contents、copy、file_get_contents等读取写入操作与unlink、file_exists等删除判断文件函数之间对于路径处理的差异导致的删除绕过</h2><pre><code>&lt;?php
$filename = __DIR__ . &apos;/tmp/&apos; . $user[&apos;name&apos;];
$data = $user[&apos;info&apos;];
file_put_contents($filename, $data);
if (file_exists($filename)) {
    unlink($filename);
}
?&gt;
</code></pre><blockquote>
<p>查看php源码，其实我们能发现，php读取、写入文件，都会调用php_stream_open_wrapper_ex来打开流，而判断文件存在、重命名、删除文件等操作则无需打开文件流。<br>我们跟一跟php_stream_open_wrapper_ex就会发现，其实最后会使用tsrm_realpath函数来将filename给标准化成一个绝对路径。而文件删除等操作则不会，这就是二者的区别。<br> 所以，如果我们传入的是文件名中包含一个不存在的路径，写入的时候因为会处理掉“../”等相对路径，所以不会出错；判断、删除的时候因为不会处理，所以就会出现“No such file or directory”的错误。</p>
</blockquote>
<p>于是乎linux可以通过xxxxx/../test.php、test.php/. windows可以通过test.php:test test.ph&lt;来绕过文件删除,此外发现还可以使用伪协议php://filter/resource=1.php在file_ge_contents、copy等中读取文件内容，却可以绕过文件删除</p>
<h2 id="extract-、parse-str-等变量覆盖"><a href="#extract-、parse-str-等变量覆盖" class="headerlink" title="extract()、parse_str() 等变量覆盖"></a>extract()、parse_str() 等变量覆盖</h2><p>extract函数从数组导入变量（如\$_GET、 \$_POST）,将数组的键名作为变量的值。而parse_str函数则是从类似name=Bill&amp;age=60的格式字符串解析变量.如果在使用第一个函数没有设置EXTR_SKIP或者EXTR_PREFIX_SAME等处理变量冲突的参数时、第二个函数没有使用数组接受变量时将会导致变量覆盖的问题</p>
<h2 id="intval-整数溢出、向下取整和整形判断的问题"><a href="#intval-整数溢出、向下取整和整形判断的问题" class="headerlink" title="intval()整数溢出、向下取整和整形判断的问题"></a>intval()整数溢出、向下取整和整形判断的问题</h2><pre><code>32位系统最大的带符号范围为-2147483648 到 2147483647，64位最大的是 9223372036854775807
</code></pre><p>​ 因此，在32位系统上 intval(‘1000000000000’) 会返回 2147483647</p>
<pre><code>此外intval(10.99999)会返回10，intval和int等取整都是’截断’取整，并不是四舍五入
intval函数进去取整时，是直到遇上数字或者正负号才开始进行转换，之后在遇到非数字或者结束符号（\0）时结束转换
</code></pre><h2 id="浮点数精度问题导致的大小比较问题"><a href="#浮点数精度问题导致的大小比较问题" class="headerlink" title="浮点数精度问题导致的大小比较问题"></a>浮点数精度问题导致的大小比较问题</h2><p>当小数小于10^-16后，PHP对于小数就大小不分了<br>var_dump(1.000000000000000 == 1) &gt;&gt; TRUE<br>var_dump(1.0000000000000001 == 1) &gt;&gt; TRUE</p>
<h2 id="is-numeric-与intval-特性差异"><a href="#is-numeric-与intval-特性差异" class="headerlink" title="is_numeric()与intval()特性差异"></a>is_numeric()与intval()特性差异</h2><pre><code>is_numeric函数在判断是否是数字时会忽略字符串开头的’ ‘、’\t’、’\n’、’\r’、’\v’、’\f’。
</code></pre><p>​ 而’.’可以出现在任意位置，E、e能出现在参数中间，仍可以被判断为数字。也就是说is_numeric(“\r\n\t 0.1e2”) &gt;&gt; TRUE</p>
<pre><code>intval()函数会忽略’’ ‘\n’、’\r’、’\t’、’\v’、’\0’ ，也就是说intval(“\r\n\t 12”) &gt;&gt; 12
</code></pre><h2 id="strcmp-数组比较绕过"><a href="#strcmp-数组比较绕过" class="headerlink" title="strcmp()数组比较绕过"></a>strcmp()数组比较绕过</h2><p>int strcmp ( string $ str1 , string \$str2 )</p>
<p>参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 &lt; 0；</p>
<p>如果 str1 大于 str2 返回 &gt; 0；如果两者相等，返回 0。</p>
<p>但是如果传入的两个变量是数组的话，函数会报错返回NULL，如果只是用strcmp()==0来判断的话就可以绕过</p>
<h2 id="sha1-、md5-函数传入数组比较绕过"><a href="#sha1-、md5-函数传入数组比较绕过" class="headerlink" title="sha1()、md5() 函数传入数组比较绕过"></a>sha1()、md5() 函数传入数组比较绕过</h2><p>sha1（） MD5（）函数默认接收的参数是字符串类型，但是如果如果传入的参数是数组的话，函数就会报错返回NULL。类似sha1(\$_GET[‘name’]) === sha1(\$_GET[‘password’])的比较就可以绕过</p>
<h2 id="弱类型-比较绕过"><a href="#弱类型-比较绕过" class="headerlink" title="弱类型==比较绕过"></a>弱类型==比较绕过</h2><p>这方面问题普及的很多，不作过多的解释</p>
<pre><code>md5(‘240610708’); // 0e462097431906509019562988736854
md5(‘QNKCDZO’); // 0e830400451993494058024219903391
md5(‘240610708’) == md5(‘QNKCDZO’)
md5(‘aabg7XSs’) == md5(‘aabC9RqS’)
sha1(‘aaroZmOk’) == sha1(‘aaK1STfY’)
sha1(‘aaO8zKZF’) == sha1(‘aa3OFF9m’)
‘0010e2’ == ‘1e3’
‘0x1234Ab’ == ‘1193131‘
‘0xABCdef’ == ‘ 0xABCdef’
当转换为boolean时，以下只被认为是FALSE：FALSE、0、0.0、“”、“0”、array()、NULL
PHP 7 以前的版本里，如果向八进制数传递了一个非法数字（即 8 或 9），则后面其余数字会被忽略。var_dump(0123)=var_dump(01239)=83
PHP 7 以后，会产生 Parse Error。
字符串转换为数值时，若字符串开头有数字，则转为数字并省略后面的非数字字符。若一开头没有数字则转换为0
\$foo = 1 + “bob-1.3e3”; // $foo is integer (1)
\$foo = 1 + “bob3”; // $foo is integer (1)
\$foo = 1 + “10 Small Pigs”; // $foo is integer (11)
‘’ == 0 == false
‘123’ == 123
‘abc’ == 0
‘123a’ == 123
‘0x01’ == 1
‘0e123456789’ == ‘0e987654321’
[false] == [0] == [NULL] == [‘’]
NULL == false == 0» true == 1
</code></pre><h2 id="eregi-匹配绕过"><a href="#eregi-匹配绕过" class="headerlink" title="eregi()匹配绕过"></a>eregi()匹配绕过</h2><p>eregi（）默认接收字符串参数，如果传入数组，函数会报错并返回NULL。同时还可以%00 截断进行绕过</p>
<h2 id="PHP变量名不能带有点-和空格，否则在会被转化为下划线"><a href="#PHP变量名不能带有点-和空格，否则在会被转化为下划线" class="headerlink" title="PHP变量名不能带有点[.] 和空格，否则在会被转化为下划线[_]"></a>PHP变量名不能带有点[.] 和空格，否则在会被转化为下划线[_]</h2><pre><code>parse_str(&quot;na.me=admin&amp;pass wd=123&quot;,$test);
var_dump($test); 
array(2) {
  [&quot;na_me&quot;]=&gt;
  string(5) &quot;admin&quot;
  [&quot;pass_wd&quot;]=&gt;
  string(3) &quot;123&quot;
}
</code></pre><p>PS：通过$_SERVER[‘REQUEST_URI’]方式获得的参数不会进行转换</p>
<h2 id="REQUEST是直接从GET，POST-和-COOKIE中取值，不是他们的引用。即使后续GET，POST-和-COOKIE发生了变化，也不会影响-REQUEST的结果"><a href="#REQUEST是直接从GET，POST-和-COOKIE中取值，不是他们的引用。即使后续GET，POST-和-COOKIE发生了变化，也不会影响-REQUEST的结果" class="headerlink" title="\$_REQUEST是直接从GET，POST 和 COOKIE中取值，不是他们的引用。即使后续GET，POST 和 COOKIE发生了变化，也不会影响$_REQUEST的结果"></a>\$_REQUEST是直接从GET，POST 和 COOKIE中取值，不是他们的引用。即使后续GET，POST 和 COOKIE发生了变化，也不会影响$_REQUEST的结果</h2><p>php在遇到相同参数时接受的是第二个参数<br>in_arrary()函数默认进行松散比较（进行类型转换）</p>
<pre><code>in_arrary(“1asd”,arrart(1,2,3,4))    =&gt; true
in_arrary(“1asd”,arrart(1,2,3,4),TRUE)    =&gt; false   \\(需要设置strict参数为true才会进行严格比较，进行类型检测)
</code></pre><p>htmlspecialchars()函数默认只转义双引号不转义单引号，如果都转义的话需要添加上参数ENT_QUOTES<br>在php4、php&lt;5.2.1中，变量的key值不受magic_quotes_gpc影响<br>sprintf()格式化漏洞（可以吃掉转义后的单引号）<br>printf（）和sprintf（）函数中可以通过使用%接一个字符来进行padding功能<br>例如%10s 字符串会默认在左侧填充空格至长度为10，还可以 %010s 会使用字符0进行填充，但是如果我们想要使用别的字符进行填充，需要使用 ‘ 单引号进行标识，例如 %’#10s 这个就是使用#进行填充（百分号不仅会吃掉’单引号，还会吃掉\ 斜杠）<br>同时sprintf（）可以使用指定参数位置的写法</p>
<pre><code>&lt;?php
$format  = &apos;This %2$s contains %1$04d monkeys&apos;;
echo sprintf($format,$num,$location);
?&gt;
以上实例会输出:
The tree contains 0005 monkeys
</code></pre><p>%后面的数字代表第几个参数，$后代表格式化类型<br>于是当我们输入的特殊字符被放到引号中进行转义时，但是又使用了sprintf函数进行拼接时<br>例如%1$’%s’ 中的 ‘%被当成使用%进行padding，导致后一个’逃逸了<br>还有一种情况就是’被转义成了\’,例如输入%’ and 1=1#进入，存在SQL过滤，’被转成了\’<br>于是sql语句变成了 select * from user where username = ‘%\’ and 1=1#’;<br>如果这个语句被使用sprintf函数进行了拼接，%后的\被吃掉了，导致了’逃逸</p>
<pre><code>&lt;?php
$sql = &quot;select * from user where username = &apos;%\&apos; and 1=1#&apos;;&quot;;
$args = &quot;admin&quot;;
echo sprintf( $sql, $args ) ;
//result: select * from user where username = &apos;&apos; and 1=1#&apos;
?&gt;
</code></pre><p>不过这样容易遇到 PHP Warning: sprintf(): Too few arguments的报错<br>这个时候我们可以使用%1$来吃掉转移添加的\</p>
<pre><code>&lt;?php
$sql = &quot;select * from user where username = &apos;%1$\&apos; and 1=1#&apos; and password=&apos;%s&apos;;&quot;;
$args = &quot;admin&quot;;
echo sprintf( $sql, $args) ;
//result: select * from user where username = &apos;&apos; and 1=1#&apos; and password=&apos;admin&apos;;
?&gt;
</code></pre><h2 id="php中-赋值运算的优先级高于and"><a href="#php中-赋值运算的优先级高于and" class="headerlink" title="php中 = 赋值运算的优先级高于and"></a>php中 = 赋值运算的优先级高于and</h2><p>$c = is_numeric($a) and is_numeric($b) 程序本意是要a、b都为数字才会继续，但是当\$a为数字时，会先赋值给\$c，所以可能导致$b绕过检测</p>
<h2 id="parse-url与libcurl对与url的解析差异可能导致ssrf"><a href="#parse-url与libcurl对与url的解析差异可能导致ssrf" class="headerlink" title="parse_url与libcurl对与url的解析差异可能导致ssrf"></a>parse_url与libcurl对与url的解析差异可能导致ssrf</h2><pre><code>当url中有多个@符号时，parse_url中获取的host是最后一个@符号后面的host，而libcurl则是获取的第一个@符号之后的。因此当代码对http://user@eval.com:80@baidu.com 进行解析时，PHP获取的host是baidu.com是允许访问的域名，而最后调用libcurl进行请求时则是请求的eval.com域名，可以造成ssrf绕过
此外对于https://evil@baidu.com这样的域名进行解析时,php获取的host是`evil@baidu.com`，但是libcurl获取的host却是evil.com
</code></pre><h2 id="url标准的灵活性导致绕过filter-var与parse-url进行ssrf"><a href="#url标准的灵活性导致绕过filter-var与parse-url进行ssrf" class="headerlink" title="url标准的灵活性导致绕过filter_var与parse_url进行ssrf"></a>url标准的灵活性导致绕过filter_var与parse_url进行ssrf</h2><p>filter_var()函数对于<a href="http://evil.com;google.com" target="_blank" rel="noopener">http://evil.com;google.com</a> 会返回false也就是认为url格式错误，但是对于0://evil.com:80;google.com:80/ 、0://evil.com:80,google.com:80/、0://evil.com:80\google.com:80/却返回true。</p>
<h2 id="通过file-get-contents获取网页内容并返回到客户端有可能造成xss"><a href="#通过file-get-contents获取网页内容并返回到客户端有可能造成xss" class="headerlink" title="通过file_get_contents获取网页内容并返回到客户端有可能造成xss"></a>通过file_get_contents获取网页内容并返回到客户端有可能造成xss</h2><p>例如如下代码</p>
<pre><code>if(filter_var($argv[1], FILTER_VALIDATE_URL)) {
   // parse URL
   $r = parse_url($argv[1]);
   print_r($r);
   // check if host ends with google.com
   if(preg_match(&apos;/baidu\.com$/&apos;, $r[&apos;host&apos;])) {
      // get page from URL
      $a = file_get_contents($argv[1]);
      echo($a);
   } else {
      echo &quot;Error: Host not allowed&quot;;
   }
} else {
   echo &quot;Error: Invalid URL&quot;;
}
</code></pre><p>虽然通过filter_var函数对url的格式进行检查，并且使用正则对url的host进行限定<br>但是可以通过<code>data://baidu.com/plain;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pgo=</code>页面会将<code>&lt;script&gt;alert(1)&lt;/script&gt;</code>返回给客户端，就有可能造成xss</p>
<h2 id="序列化漏洞常见的魔法函数"><a href="#序列化漏洞常见的魔法函数" class="headerlink" title="序列化漏洞常见的魔法函数"></a>序列化漏洞常见的魔法函数</h2><p>construct():当一个类被创建时自动调用<br>destruct():当一个类被销毁时自动调用<br>invoke():当把一个类当作函数使用时自动调用<br>tostring():当把一个类当作字符串使用时自动调用<br>wakeup():当调用unserialize()函数时自动调用<br>sleep():当调用serialize()函数时自动调用<br>__call():当要调用的方法不存在或权限不足时自动调用</p>

    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>原文作者: <a href="https://threst.github.io">threst</a>
            <p>原文链接: <a href="https://threst.github.io/2018/10/04/php安全/">https://threst.github.io/2018/10/04/php安全/</a>
            <p>发表日期: <a href="https://threst.github.io/2018/10/04/php安全/">October 4th 2018, 1:34:12</a>
            <p>版权声明: 本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "/2018/10/04/Netcat/" title= netcat食用指南 >
                    <div class="nextTitle">netcat食用指南</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/2018/10/04/phpgd绕过/" title= phpgd绕过 >
                    <div class="prevTitle">phpgd绕过</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!--PC版-->

    <!--PC版-->


    
    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:3451078463@qq.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/threst" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
        <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span>
        </span>
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-PHP敏感配置项"><span class="toc-number">1.</span> <span class="toc-text">0x01 PHP敏感配置项</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#register-globals-php版本小于5-4时存在"><span class="toc-number">1.1.</span> <span class="toc-text">register_globals(php版本小于5.4时存在)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#allow-url-include-php版本大于5-2默认为off"><span class="toc-number">1.2.</span> <span class="toc-text">allow_url_include(php版本大于5.2默认为off)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#magic-quato-gpc（php版本小于5-4存在）"><span class="toc-number">1.3.</span> <span class="toc-text">magic_quato_gpc（php版本小于5.4存在）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#magic-quato-runtime（php版本小于5-4存在）"><span class="toc-number">1.4.</span> <span class="toc-text">magic_quato_runtime（php版本小于5.4存在）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#magic-quato-sybase（php版本小于5-4存在）"><span class="toc-number">1.5.</span> <span class="toc-text">magic_quato_sybase（php版本小于5.4存在）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#open-basedir"><span class="toc-number">1.6.</span> <span class="toc-text">open_basedir</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-PHP常见敏感函数"><span class="toc-number">2.</span> <span class="toc-text">0x02 PHP常见敏感函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-常见漏洞解析"><span class="toc-number">3.</span> <span class="toc-text">0x03 常见漏洞解析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#各种问题可以导致系统重装"><span class="toc-number">3.1.</span> <span class="toc-text">各种问题可以导致系统重装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-未对系统是否已经安装进行判断"><span class="toc-number">3.1.1.</span> <span class="toc-text">1.未对系统是否已经安装进行判断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-变量覆盖绕过"><span class="toc-number">3.1.2.</span> <span class="toc-text">2.变量覆盖绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-判断已安装后未exit-退出程序"><span class="toc-number">3.1.3.</span> <span class="toc-text">3.判断已安装后未exit()退出程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-还可以借助任意文件删除的漏洞来删除lock文件，然后进行重装（PS-这个就留在任意文件删除再分析）"><span class="toc-number">3.1.4.</span> <span class="toc-text">4.还可以借助任意文件删除的漏洞来删除lock文件，然后进行重装（PS:这个就留在任意文件删除再分析）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Ecshop-支付宝插件全局转义绕过导致sql注入"><span class="toc-number">3.1.4.1.</span> <span class="toc-text">1.Ecshop 支付宝插件全局转义绕过导致sql注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-格式化字符串导致的单引号逃逸"><span class="toc-number">3.1.4.2.</span> <span class="toc-text">2.格式化字符串导致的单引号逃逸</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-php安全"><span class="toc-number">4.</span> <span class="toc-text">0x03 php安全</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#strcmp-弱类型比较特性"><span class="toc-number">4.1.</span> <span class="toc-text">strcmp 弱类型比较特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Linux-PHP-写入与删除文件差异特性"><span class="toc-number">4.2.</span> <span class="toc-text">Linux PHP 写入与删除文件差异特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#preg-replace-利用-0-截断执行代码"><span class="toc-number">4.3.</span> <span class="toc-text">preg_replace 利用 \0 截断执行代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#利用php-filter流绕过死亡exit"><span class="toc-number">4.4.</span> <span class="toc-text">利用php filter流绕过死亡exit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#filter-var-FILTER-VALIDATE-EMAIL-绕过"><span class="toc-number">4.5.</span> <span class="toc-text">filter_var FILTER_VALIDATE_EMAIL 绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#控制Nginx虚拟主机的Host"><span class="toc-number">4.6.</span> <span class="toc-text">控制Nginx虚拟主机的Host</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#利用GBK编码吃反引号"><span class="toc-number">4.7.</span> <span class="toc-text">利用GBK编码吃反引号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iconv-绕过上传白名单"><span class="toc-number">4.8.</span> <span class="toc-text">iconv()绕过上传白名单</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP-mt-rand-随机数预测"><span class="toc-number">4.9.</span> <span class="toc-text">PHP mt_rand() 随机数预测</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP5-rand-随机数预测"><span class="toc-number">4.10.</span> <span class="toc-text">PHP5 rand() 随机数预测</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#利用json-encode吃转义符"><span class="toc-number">4.11.</span> <span class="toc-text">利用json_encode吃转义符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#file-put-contents写入文件绕过内容黑名单"><span class="toc-number">4.12.</span> <span class="toc-text">file_put_contents写入文件绕过内容黑名单</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP-MD5-比较的陷阱"><span class="toc-number">4.13.</span> <span class="toc-text">PHP MD5 比较的陷阱</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP-5-6-11-数组比较Bug"><span class="toc-number">4.14.</span> <span class="toc-text">PHP 5.6.11 数组比较Bug</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-代码审计关注点）"><span class="toc-number">5.</span> <span class="toc-text">0x04 代码审计关注点）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#file-put-contents、copy、file-get-contents等读取写入操作与unlink、file-exists等删除判断文件函数之间对于路径处理的差异导致的删除绕过"><span class="toc-number">5.1.</span> <span class="toc-text">file_put_contents、copy、file_get_contents等读取写入操作与unlink、file_exists等删除判断文件函数之间对于路径处理的差异导致的删除绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#extract-、parse-str-等变量覆盖"><span class="toc-number">5.2.</span> <span class="toc-text">extract()、parse_str() 等变量覆盖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#intval-整数溢出、向下取整和整形判断的问题"><span class="toc-number">5.3.</span> <span class="toc-text">intval()整数溢出、向下取整和整形判断的问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#浮点数精度问题导致的大小比较问题"><span class="toc-number">5.4.</span> <span class="toc-text">浮点数精度问题导致的大小比较问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#is-numeric-与intval-特性差异"><span class="toc-number">5.5.</span> <span class="toc-text">is_numeric()与intval()特性差异</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#strcmp-数组比较绕过"><span class="toc-number">5.6.</span> <span class="toc-text">strcmp()数组比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sha1-、md5-函数传入数组比较绕过"><span class="toc-number">5.7.</span> <span class="toc-text">sha1()、md5() 函数传入数组比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#弱类型-比较绕过"><span class="toc-number">5.8.</span> <span class="toc-text">弱类型==比较绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#eregi-匹配绕过"><span class="toc-number">5.9.</span> <span class="toc-text">eregi()匹配绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP变量名不能带有点-和空格，否则在会被转化为下划线"><span class="toc-number">5.10.</span> <span class="toc-text">PHP变量名不能带有点[.] 和空格，否则在会被转化为下划线[_]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#REQUEST是直接从GET，POST-和-COOKIE中取值，不是他们的引用。即使后续GET，POST-和-COOKIE发生了变化，也不会影响-REQUEST的结果"><span class="toc-number">5.11.</span> <span class="toc-text">\$_REQUEST是直接从GET，POST 和 COOKIE中取值，不是他们的引用。即使后续GET，POST 和 COOKIE发生了变化，也不会影响$_REQUEST的结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php中-赋值运算的优先级高于and"><span class="toc-number">5.12.</span> <span class="toc-text">php中 = 赋值运算的优先级高于and</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#parse-url与libcurl对与url的解析差异可能导致ssrf"><span class="toc-number">5.13.</span> <span class="toc-text">parse_url与libcurl对与url的解析差异可能导致ssrf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#url标准的灵活性导致绕过filter-var与parse-url进行ssrf"><span class="toc-number">5.14.</span> <span class="toc-text">url标准的灵活性导致绕过filter_var与parse_url进行ssrf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#通过file-get-contents获取网页内容并返回到客户端有可能造成xss"><span class="toc-number">5.15.</span> <span class="toc-text">通过file_get_contents获取网页内容并返回到客户端有可能造成xss</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#序列化漏洞常见的魔法函数"><span class="toc-number">5.16.</span> <span class="toc-text">序列化漏洞常见的魔法函数</span></a></li></ol></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-archive"> Total : 31 </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/14</span><a class="archive-post-title" href= "/2018/11/14/pwn_repeater/" >pwn之路_repeater(山东省赛)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/11</span><a class="archive-post-title" href= "/2018/11/11/ctf/" >无处安放的wp(不定期更)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/11</span><a class="archive-post-title" href= "/2018/11/11/pwn之路_ret2text/" >pwn之路_ret2text</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/02</span><a class="archive-post-title" href= "/2018/11/02/HID/" >BadUSB初探</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/02</span><a class="archive-post-title" href= "/2018/11/02/D-CTFQuals2018/" >D-CTFQuals2018</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/16</span><a class="archive-post-title" href= "/2018/10/16/install/" >parrot安装</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/14</span><a class="archive-post-title" href= "/2018/10/14/极客大挑战/" >极客大挑战wp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/04</span><a class="archive-post-title" href= "/2018/10/04/phpgd绕过/" >phpgd绕过</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/04</span><a class="archive-post-title" href= "/2018/10/04/php安全/" >php安全</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/04</span><a class="archive-post-title" href= "/2018/10/04/Netcat/" >netcat食用指南</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/04</span><a class="archive-post-title" href= "/2018/10/04/csaw2018wp/" >csaw 2018 wp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/04</span><a class="archive-post-title" href= "/2018/10/04/tjctf2018misc/" >tjctf2018wp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/04</span><a class="archive-post-title" href= "/2018/10/04/网鼎杯wp/" >网鼎杯wp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/18</span><a class="archive-post-title" href= "/2018/09/18/cve-2017-11882/" >CVE-2017-11882复现</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/15</span><a class="archive-post-title" href= "/2018/09/15/noxctf2018wp/" >noxctf2018wp</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/11</span><a class="archive-post-title" href= "/2018/09/11/CVE-2017-8464漏洞复现/" >CVE-2017-8464漏洞复现</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/09</span><a class="archive-post-title" href= "/2018/09/09/双杀0day漏洞(CVE-2018-8174)复现/" >双杀0day漏洞(CVE-2018-8174)复现</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/28</span><a class="archive-post-title" href= "/2018/08/28/CTF之隐写术/" >ctf之隱寫術</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/15</span><a class="archive-post-title" href= "/2018/06/15/kali破解xp开机密码/" >艰难的kali破解xp开机密码之路</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/06</span><a class="archive-post-title" href= "/2018/06/06/利用 PATH 环境变量进行 Linux 提权/" >利用 PATH 环境变量进行 Linux 提权</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/01</span><a class="archive-post-title" href= "/2018/06/01/61随想/" >61随想</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/01</span><a class="archive-post-title" href= "/2018/06/01/常见文件格式分析/" >常见文件格式分析</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/01</span><a class="archive-post-title" href= "/2018/06/01/如何在MIMIKATZ添加模块/" >如何在MIMIKATZ添加模块</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/30</span><a class="archive-post-title" href= "/2018/05/30/实验吧wp/" >实验吧wp(持续更新)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/29</span><a class="archive-post-title" href= "/2018/05/29/kali安装docker/" >kali下安装docker</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/22</span><a class="archive-post-title" href= "/2018/05/22/你肯定不知道的GraphQL安全概述和测试技巧/" >你肯定不知道的GraphQL安全概述和测试技巧</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/17</span><a class="archive-post-title" href= "/2018/05/17/git一条龙(一看就会的那种)/" >git一条龙(一看就会的那种)</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span><a class="archive-post-title" href= "/2018/05/12/逆向工程基础 - Linux x64/" >逆向入门--linux64</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span><a class="archive-post-title" href= "/2018/05/12/逆向工程入门— ARM64上的Linux/" >逆向入门--ARM64的linux</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span><a class="archive-post-title" href= "/2018/05/12/艰难的hexo上线/" >艰难的hexo上线</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/12</span><a class="archive-post-title" href= "/2018/05/12/isccwp/" >isccwp</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="瞎记罢写"><span class="iconfont-archer">&#xe606;</span>瞎记罢写</span>
    
        <span class="sidebar-tag-name" data-tags="ctf"><span class="iconfont-archer">&#xe606;</span>ctf</span>
    
        <span class="sidebar-tag-name" data-tags="CVE-2017-8464"><span class="iconfont-archer">&#xe606;</span>CVE-2017-8464</span>
    
        <span class="sidebar-tag-name" data-tags="BadUSB"><span class="iconfont-archer">&#xe606;</span>BadUSB</span>
    
        <span class="sidebar-tag-name" data-tags="netcat"><span class="iconfont-archer">&#xe606;</span>netcat</span>
    
        <span class="sidebar-tag-name" data-tags="CVE-2017-11882"><span class="iconfont-archer">&#xe606;</span>CVE-2017-11882</span>
    
        <span class="sidebar-tag-name" data-tags="git"><span class="iconfont-archer">&#xe606;</span>git</span>
    
        <span class="sidebar-tag-name" data-tags="系统"><span class="iconfont-archer">&#xe606;</span>系统</span>
    
        <span class="sidebar-tag-name" data-tags="kali docker"><span class="iconfont-archer">&#xe606;</span>kali docker</span>
    
        <span class="sidebar-tag-name" data-tags="writeup"><span class="iconfont-archer">&#xe606;</span>writeup</span>
    
        <span class="sidebar-tag-name" data-tags="php"><span class="iconfont-archer">&#xe606;</span>php</span>
    
        <span class="sidebar-tag-name" data-tags="pwn"><span class="iconfont-archer">&#xe606;</span>pwn</span>
    
        <span class="sidebar-tag-name" data-tags="安全客弃婴"><span class="iconfont-archer">&#xe606;</span>安全客弃婴</span>
    
        <span class="sidebar-tag-name" data-tags="CVE-2018-8174"><span class="iconfont-archer">&#xe606;</span>CVE-2018-8174</span>
    
        <span class="sidebar-tag-name" data-tags="writeup ctf"><span class="iconfont-archer">&#xe606;</span>writeup ctf</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: '/',
        author: 'threst'
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- busuanzi  -->
    
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
    
    </body>
</html>


